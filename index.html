<!--https://codepen.io/baris/pen/XVzGdL-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="time.css">
    <title>UNIVERSITY</title>
    <style>
    #map .path {
        stroke: white;
        stroke-width: 0.5px;
        fill: black;
    }
    .box {
	display: flex;
	align-self: flex-start;
	width: 100%;
  height: 100%;

	
  }
  .box .nav{
	  align-self: center;
  }
  .box #map{
	  align-self: flex-start;
  }
    </style>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    
    <script src="https://d3js.org/topojson.v2.min.js"></script>
    <script src="timeseries.js"></script>
</head>
<body>
  <div class="box">
  <nav> TABS HERE</nav>
  
  <div class="container" id="map"></div>
<script type="text/javascript">
const width = 800;
const height = 500;
const svg = d3.select("#map").append("svg")
    .attr("width", width)
    .attr("height", height);
 
const projection = d3.geoMercator()
    .translate([width / 2, height / 2]) // translate to center of screen
    .scale([100]); // scale things down so see entire US
 
const path = d3.geoPath().projection(projection);
 
d3.json("GeoMap/custom.geo.json", function(error, uState) {
if (error) throw error;
    svg.selectAll('path')
        .data(uState.features)
        .enter()
        .append('path')
        .attr("d", path)
});
var old;
var zoom = d3.zoom()
.scaleExtent([1, 8])
.on('zoom', function() {
  console.log(d3.event.transform)
    if(d3.event.transform.x*d3.event.transform.k>600){
      d3.event.transform.x=old.x;
    }
    if(d3.event.transform.x/d3.event.transform.k<-600){
      d3.event.transform.x=old.x;
    }
    if(d3.event.transform.y*d3.event.transform.k>400){
      d3.event.transform.y=old.y;
    }
    if(d3.event.transform.y/d3.event.transform.k<-300){
      d3.event.transform.y=old.y;
    }
    old=d3.event.transform
    svg.selectAll('path')
     .attr('transform', d3.event.transform);
});

svg.call(zoom);

const drag_handler = d3.drag()
.on('start', drag_start)
.on('drag', drag_drag)

function drag_start() {
start_x = +d3.event.x
start_y = +d3.event.y
}

function drag_drag(d) {
//Get the current scale of the circle 
//case where we haven't scaled the circle yet
// get lon x lat
console.log('lon x lat', projection.invert([d3.event.x, d3.event.y]))

d3.select(this)
.attr('cx', d.x = 0).attr('cy', d.y = 0)
}

</script>
<div class="container" id="data1"> 
  <button id="show_data" onclick=display_data()>here </button>
</div>

</div>
</body>
<script src="util/d3.min.js"></script>
</html>